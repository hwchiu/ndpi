
#ifdef NDPI_OLD_RESULT_APP_XBOX
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_XBOX,
				      ndpi_search_http_tcp,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_WITH_PAYLOAD,
				      NO_SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);
#endif

#ifdef NDPI_OLD_RESULT_APP_WINDOWS_UPDATE
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_WINDOWS_UPDATE,
				      ndpi_search_http_tcp,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_WITH_PAYLOAD,
				      NO_SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);
#endif

#ifdef NDPI_OLD_RESULT_APP_QQ
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_QQ,
				      ndpi_search_http_tcp,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_WITH_PAYLOAD,
				      NO_SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);
#endif

#ifdef NDPI_OLD_RESULT_APP_MOVE
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_MOVE,
				      ndpi_search_http_tcp,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_WITH_PAYLOAD,
				      NO_SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);
#endif


#ifdef NDPI_OLD_RESULT_APP_STUN
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_STUN,
				      ndpi_search_stun,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_OR_UDP_WITH_PAYLOAD,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif

#ifdef NDPI_OLD_RESULT_APP_XBOX
  NDPI_ADD_PROTOCOL_TO_BITMASK(ndpi_mod->callback_buffer[a].detection_bitmask, NDPI_OLD_RESULT_APP_XBOX);

#endif
#ifdef NDPI_OLD_RESULT_APP_WINDOWS_UPDATE
  NDPI_ADD_PROTOCOL_TO_BITMASK(ndpi_mod->callback_buffer[a].detection_bitmask, NDPI_OLD_RESULT_APP_WINDOWS_UPDATE);
#endif
  /* Update callback_buffer index */
  a++;
#endif

#ifdef NDPI_OLD_RESULT_APP_WINMX
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_WINMX,
				      ndpi_search_winmx_tcp,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_WITH_PAYLOAD_WITHOUT_RETRANSMISSION,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif

#ifdef NDPI_OLD_RESULT_APP_MSN

  NDPI_BITMASK_RESET(ndpi_mod->callback_buffer[a].excluded_protocol_bitmask);

  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_MSN,
				      ndpi_search_msn,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_OR_UDP_WITH_PAYLOAD_WITHOUT_RETRANSMISSION,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

#ifdef NDPI_OLD_RESULT_APP_OSCAR
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_OSCAR,
				      ndpi_search_oscar,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_OR_UDP_WITH_PAYLOAD_WITHOUT_RETRANSMISSION,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif

#ifdef NDPI_OLD_RESULT_APP_SOULSEEK
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_SOULSEEK,
				      ndpi_search_soulseek_tcp,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_WITH_PAYLOAD,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif

#ifdef NDPI_OLD_RESULT_APP_IRC
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_IRC,
				      ndpi_search_irc_tcp,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_WITH_PAYLOAD_WITHOUT_RETRANSMISSION,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

#ifdef NDPI_OLD_RESULT_APP_UNENCRYPED_JABBER
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_UNENCRYPED_JABBER,
				      ndpi_search_jabber_tcp,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_OR_UDP_WITHOUT_RETRANSMISSION,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

#ifdef NDPI_OLD_RESULT_APP_FILETOPIA
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_FILETOPIA,
				      ndpi_search_filetopia_tcp,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_WITH_PAYLOAD_WITHOUT_RETRANSMISSION,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif

#ifdef NDPI_OLD_RESULT_CONTENT_MMS
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_CONTENT_MMS,
				      ndpi_search_mms_tcp,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_WITH_PAYLOAD_WITHOUT_RETRANSMISSION,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif

#ifdef NDPI_OLD_RESULT_APP_TVANTS
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_TVANTS,
				      ndpi_search_tvants_udp,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_OR_UDP_WITH_PAYLOAD,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif

#ifdef NDPI_OLD_RESULT_APP_TVUPLAYER
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_TVUPLAYER,
				      ndpi_search_tvuplayer,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_OR_UDP_WITH_PAYLOAD,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif
#ifdef NDPI_OLD_RESULT_APP_IAX
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_IAX,
				      ndpi_search_iax,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_UDP_WITH_PAYLOAD,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif
#ifdef NDPI_OLD_RESULT_APP_MGCP
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_MGCP,
				      ndpi_search_mgcp,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_UDP_WITH_PAYLOAD,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif
#ifdef NDPI_OLD_RESULT_APP_ZATTOO
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_ZATTOO,
				      ndpi_search_zattoo,
				      NDPI_SELECTION_BITMASK_PROTOCOL_TCP_OR_UDP_WITH_PAYLOAD,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);


#ifdef NDPI_OLD_RESULT_APP_QQ
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_QQ,
				      ndpi_search_qq,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_OR_UDP_WITH_PAYLOAD_WITHOUT_RETRANSMISSION,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif
#ifdef NDPI_OLD_RESULT_APP_THUNDER
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_THUNDER,
				      ndpi_search_thunder,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_OR_UDP_WITH_PAYLOAD_WITHOUT_RETRANSMISSION,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif

#ifdef NDPI_OLD_RESULT_APP_SOCRATES
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_SOCRATES,
				      ndpi_search_socrates,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_OR_UDP_WITH_PAYLOAD,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif

#ifdef NDPI_OLD_RESULT_APP_XBOX
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_XBOX,
				      ndpi_search_xbox,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_OR_UDP_WITH_PAYLOAD_WITHOUT_RETRANSMISSION,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif

#ifdef NDPI_OLD_RESULT_APP_POSTGRES
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_POSTGRES,
				      ndpi_search_postgres_tcp,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_WITH_PAYLOAD_WITHOUT_RETRANSMISSION,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif

#ifdef NDPI_OLD_RESULT_APP_QUAKE
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_QUAKE,
				      ndpi_search_quake,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_UDP_WITH_PAYLOAD,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif

#ifdef NDPI_OLD_RESULT_APP_BATTLEFIELD
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_BATTLEFIELD,
				      ndpi_search_battlefield,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_UDP_WITH_PAYLOAD,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif

#ifdef NDPI_OLD_RESULT_APP_ICECAST

  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_ICECAST,
				      ndpi_search_icecast_tcp,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_WITH_PAYLOAD,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

#ifdef NDPI_OLD_RESULT_APP_SHOUTCAST
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_SHOUTCAST,
				      ndpi_search_shoutcast_tcp,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_WITH_PAYLOAD_WITHOUT_RETRANSMISSION,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

#ifdef NDPI_OLD_RESULT_APP_VEOHTV
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_VEOHTV,
				      ndpi_search_veohtv_tcp,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_OR_UDP_WITH_PAYLOAD_WITHOUT_RETRANSMISSION,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);


#ifdef NDPI_OLD_RESULT_APP_SYSLOG
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_SYSLOG,
				      ndpi_search_syslog,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_OR_UDP_WITH_PAYLOAD_WITHOUT_RETRANSMISSION,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif

#ifdef NDPI_OLD_RESULT_APP_MDNS
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_MDNS,
				      ndpi_search_mdns,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_UDP_WITH_PAYLOAD,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif

#ifdef NDPI_OLD_RESULT_APP_IPP
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_IPP,
				      ndpi_search_ipp,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_OR_UDP_WITH_PAYLOAD_WITHOUT_RETRANSMISSION,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif

#ifdef NDPI_OLD_RESULT_APP_LDAP
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_LDAP,
				      ndpi_search_ldap,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_OR_UDP_WITH_PAYLOAD_WITHOUT_RETRANSMISSION,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif

#ifdef NDPI_OLD_RESULT_APP_MEEBO
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_MEEBO,
				      ndpi_search_meebo,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_WITH_PAYLOAD_WITHOUT_RETRANSMISSION,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);
  /* Add protocol bitmask dependencies to detected bitmask*/
  a++;
#endif

#ifdef NDPI_OLD_RESULT_APP_AIMINI
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_AIMINI,
				      ndpi_search_aimini,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_OR_UDP_WITH_PAYLOAD,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif
#ifdef NDPI_OLD_RESULT_APP_FLORENSIA
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_FLORENSIA,
				      ndpi_search_florensia,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_OR_UDP_WITH_PAYLOAD_WITHOUT_RETRANSMISSION,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif
#ifdef NDPI_OLD_RESULT_APP_MAPLESTORY
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_MAPLESTORY,
				      ndpi_search_maplestory,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_WITH_PAYLOAD_WITHOUT_RETRANSMISSION,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif
#ifdef NDPI_OLD_RESULT_APP_DOFUS
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_DOFUS,
				      ndpi_search_dofus,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_WITH_PAYLOAD_WITHOUT_RETRANSMISSION,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif

#ifdef NDPI_OLD_RESULT_APP_FIESTA
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_FIESTA,
				      ndpi_search_fiesta,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_WITH_PAYLOAD_WITHOUT_RETRANSMISSION,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif
#ifdef NDPI_OLD_RESULT_APP_CROSSFIRE
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_CROSSFIRE,
				      ndpi_search_crossfire_tcp_udp,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_OR_UDP_WITH_PAYLOAD_WITHOUT_RETRANSMISSION,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif

#ifdef NDPI_OLD_RESULT_APP_ARMAGETRON
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_ARMAGETRON,
				      ndpi_search_armagetron_udp,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_UDP_WITH_PAYLOAD,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif

#ifdef NDPI_OLD_RESULT_APP_CITRIX
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_CITRIX,
				      ndpi_search_citrix,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_WITH_PAYLOAD_WITHOUT_RETRANSMISSION,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif

#ifdef NDPI_OLD_RESULT_APP_LOTUS_NOTES
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_LOTUS_NOTES,
				      ndpi_search_lotus_notes,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_WITH_PAYLOAD_WITHOUT_RETRANSMISSION,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif

#ifdef NDPI_OLD_RESULT_APP_TEAMSPEAK
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_TEAMSPEAK,
				      ndpi_search_teamspeak,
				      NDPI_SELECTION_BITMASK_PROTOCOL_TCP_OR_UDP_WITH_PAYLOAD,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif

#ifdef NDPI_OLD_RESULT_APP_SKINNY
  ndpi_set_bitmask_protocol_detection(ndpi_mod,detection_bitmask,a,
				      NDPI_OLD_RESULT_APP_SKINNY,
				      ndpi_search_skinny,
				      NDPI_SELECTION_BITMASK_PROTOCOL_V4_V6_TCP_WITH_PAYLOAD_WITHOUT_RETRANSMISSION,
				      SAVE_DETECTION_BITMASK_AS_UNKNOWN,
				      ADD_TO_DETECTION_BITMASK);

  /* Update callback_buffer index */
  a++;
#endif
